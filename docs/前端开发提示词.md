# 宠物关怀RAG知识库前端开发提示词

## API接口说明

### 1. 文档管理接口

#### 1.1 上传文档

- **接口**: `POST /ai/document/upload`
- **参数**: `file` (MultipartFile)
- **返回**:

```json
{
  "code": "200",
  "message": "success",
  "data": {
    "id": 1,
    "name": "文档名称.pdf",
    "fileUrl": "http://petcare.com/pet-care-ai/ai/2025/01/01/xxx.pdf",
    "fileType": "pdf",
    "fileSize": 1024000,
    "version": 1,
    "status": 1,
    "chunkCount": 10,
    "createdAt": "2025-01-01T10:00:00",
    "updatedAt": "2025-01-01T10:00:00"
  }
}
```

#### 1.2 查询文档列表

- **接口**: `GET /ai/document/list`
- **返回**:

```json
{
  "code": "200",
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "文档名称.pdf",
      "fileUrl": "http://petcare.com/pet-care-ai/ai/2025/01/01/xxx.pdf",
      "fileType": "pdf",
      "fileSize": 1024000,
      "version": 1,
      "status": 1,
      "chunkCount": 10,
      "createdAt": "2025-01-01T10:00:00",
      "updatedAt": "2025-01-01T10:00:00"
    }
  ]
}
```

#### 1.3 查询单个文档

- **接口**: `GET /ai/document/{id}`
- **返回**: 同上传文档的data结构

#### 1.4 删除文档

- **接口**: `DELETE /ai/document/{id}`
- **返回**:

```json
{
  "code": "200",
  "message": "success",
  "data": null
}
```

### 2. RAG对话接口

#### 2.1 RAG对话（基于知识库）

- **接口**: `GET /ai/rag/chat`
- **参数**:
    - `message` (String, 必填): 用户问题
    - `sessionId` (String, 可选): 会话ID，用于区分同一用户的多个会话
- **返回**: 流式响应（SSE格式），Content-Type: `text/html;charset=UTF-8`

#### 2.2 普通对话（带会话记忆）

- **接口**: `GET /ai/chatPlus`
- **参数**:
    - `message` (String, 必填): 用户消息
    - `sessionId` (String, 可选): 会话ID
- **返回**: 流式响应（SSE格式）

## 前端页面功能要求

### 1. 文档管理页面

- **文档列表展示**: 显示文档名称、类型、大小、上传时间、分块数量
- **文档上传**: 支持拖拽上传，支持格式：PDF、Word、Markdown、TXT等
- **文档删除**: 删除时提示确认，删除后自动刷新列表
- **文档预览**: 点击文档名称可预览或下载

### 2. RAG对话页面

- **对话界面**: 类似聊天界面，支持流式显示回复
- **会话管理**: 支持创建多个会话，每个会话独立记忆
- **知识库提示**: 在输入框下方提示"基于知识库回答"
- **历史记录**: 显示对话历史记录

### 3. 错误处理

- **上传失败**: 显示具体错误信息（文件过大、格式不支持等）
- **删除失败**: 提示删除失败原因
- **对话失败**: 显示网络错误或服务异常提示

## 技术建议

1. **文件上传**: 使用FormData，支持进度显示
2. **流式响应**: 使用EventSource或fetch的stream API处理SSE
3. **状态管理**: 使用Vuex/Pinia或React Redux管理文档列表和对话状态
4. **UI组件**:
    - 文档列表：表格组件
    - 文件上传：拖拽上传组件
    - 对话界面：消息气泡组件

## 未来功能规划

1. **AI问诊功能**:
    - 图片上传识别症状
    - 症状描述输入
    - 药物推荐展示

2. **宠物提醒功能**:
    - 已实现，可集成到对话中

