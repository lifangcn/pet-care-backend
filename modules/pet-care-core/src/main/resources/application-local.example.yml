# =============================================================================
# Pet Care Core 本地开发环境配置示例
# =============================================================================
# 复制此文件为 application-local.yml 并填入实际配置值
# =============================================================================

server:
  port: 8080
  tomcat:
    mbeanregistry:
      enabled: true

spring:
  # -------------------------------------------------------------------------
  # MySQL 数据库配置
  # -------------------------------------------------------------------------
  datasource:
    url: jdbc:mysql://localhost:3306/pet_care_core?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: your_mysql_password
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      # 连接池配置
      maximum-pool-size: 100      # 最大连接数
      minimum-idle: 20            # 最小空闲连接
      connection-timeout: 10000   # 获取连接超时(毫秒)
      idle-timeout: 300000        # 空闲超时(毫秒)
      max-lifetime: 1800000       # 连接最大生命周期(毫秒)
      connection-test-query: SELECT 1
      validation-timeout: 3000
      leak-detection-threshold: 60000
      pool-name: PetCareHikariPool

  # -------------------------------------------------------------------------
  # Redis 缓存配置
  # -------------------------------------------------------------------------
  data:
    redis:
      host: localhost
      port: 6379
      password: your_redis_password
      database: 0
      timeout: 3000
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  # -------------------------------------------------------------------------
  # Kafka 消息队列配置（CDC 数据同步消费）
  # -------------------------------------------------------------------------
  kafka:
    bootstrap-servers: localhost:9092
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: all
      retries: 2
      properties:
        enable.idempotence: true
    consumer:
      group-id: cdc-consumer-group  # 消费者组ID
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      auto-offset-reset: earliest
      enable-auto-commit: false
      max-poll-records: 10
    listener:
      ack-mode: manual
      concurrency: 3

# -------------------------------------------------------------------------
# 阿里云 OSS 对象存储配置
# -------------------------------------------------------------------------
aliyun:
  oss:
    endpoint: oss-cn-hangzhou.aliyuncs.com
    access-key-id: your_oss_access_key_id
    access-key-secret: your_oss_access_key_secret
    bucket-name: your_bucket_name
    enabled: true

# -------------------------------------------------------------------------
# JWT 密钥配置
# -------------------------------------------------------------------------
jwt:
  # 生成密钥: openssl rand -base64 32
  secret-key: "your_jwt_secret_key_base64_encoded"

# =============================================================================
# 配置项说明
# =============================================================================
# 1. MySQL: 本地开发数据库，需先创建 pet_care_core 数据库
# 2. Redis: 本地开发缓存服务
# 3. Kafka: CDC 数据同步消费，生产环境同步数据到 pet-care-ai
# 4. OSS: 文件存储，用于头像、图片等上传
# 5. JWT: 用户认证签名密钥，必须配置
# =============================================================================
